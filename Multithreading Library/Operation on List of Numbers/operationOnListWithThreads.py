import threading, sys, time, math

try:
    numOfThreads = int(sys.argv[1])
except:
    print("Missing Argument: Number of Threads")
    sys.exit(1)
threads = []
timeDifference = []

data = [123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,123389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 257171235381723389115, 231846842842, 814985834538542, 8142345234852, 1131821345877, 2571712353817,]
LEN = len(data)
results = [None] * LEN

rangeStart = 0
difference = int(math.ceil(LEN / numOfThreads))
rangeEnd = rangeStart + difference

def operationOverRange(data, operation, start, end):
    s = time.time()
    for i in range(start, end):
        results[i] = operation(data[i])
    e = time.time()
    timeDifference.append((e - s) * 10 ** 6)

def sumOfCubes(num):
    sum = 0
    num_str = str(num)
    for ch in num_str:
        sum += int(ch) ** 3
    return sum


if(numOfThreads == 1 or difference < 1):
    operationOverRange(data, sumOfCubes, rangeStart, LEN)
else:
    for i in range(numOfThreads):
        threads.append(threading.Thread(target=operationOverRange, args=(data.copy(), sumOfCubes, rangeStart, rangeEnd, )))
        threads[-1].start()
        rangeStart += difference
        rangeEnd = min([rangeStart+difference, LEN])

for thread in threads:
    thread.join()


print("I:", *data, sep="  ")
print("O:", *results, sep="  ")
print(f"Time taken: {sum(timeDifference)} microseconds")